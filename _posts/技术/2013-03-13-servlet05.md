---
layout: post
title: Servlet系列05：读取web.xml
category: 技术
tags: Servlet系列
keywords: servlet web.xml
description: 
---

　　web.xml是web应用程序描述文件，web.xml中的配置了一些初参数，有两种配置参数的方式，当然这两种配置方式是有区别的，一种是Servlet级别的初始化参数（init-param），一种是全局的上下文参数（context-param）,下面详细介绍这两种参数。
###1、初始化参数（init-param）
　　<init-param>是配置在<Servlet>中的，所以是Servlet级别的参数，Servlet容器在创建Servlet对象之后（接着创建ServletConfig对象），会立即调用Servlet对象的**init(ServletConfig config)**方法，将init-param里面配置的参数赋值给Servlet对象的ServletConfig属性（这一系列方法都是超类GenericServlet中的）。

**web.xml中配置的初始化参数init-param**

	  <servlet>
	  	<servlet-name>MyServlet</servlet-name>   <!-- 可以取任意字符串，但是在web.xml里要唯一  -->
	  	<servlet-class>com.richey88.servlet.MyServlet</servlet-class>
	  	
		<!--可以配置多个init-param参数-->
	  	<init-param> 
	  		<param-name>message</param-name>
	  		<param-value>welcome to myservlet</param-value>
	  	</init-param>
	  
	  </servlet>

**GenericServlet类相关代码**

		public void init(ServletConfig config)
		     throws ServletException
	   {
	     this.config = config;
	     init();   //可在自定义的Servlet中重写init()方法
	   }

　　同时，我们要想访问<init-param>中的参数就需要在Servlet中重写init()方法，且只能init()方法中访问。注意，一个Servlet不能获取别的Servlet中配置的参数。

	/**
	 * 重写init方法，加载Servlet的初始化参数（init-param）
	 */
	@Override
	public void init() throws ServletException {
		//下面这两种方式都可以加载Servlet的初始化参数，效果是一样的，
		//查看GenericServlet可知getInitParameter里面实际也是通过getServletConfig().getInitParameter("message")获取的
		System.out.println(this.getServletConfig().getInitParameter("message"));
		System.out.println(this.getInitParameter("message"));
	}

　　初始化参数的好处是，可以把一些变量放到web.xml文件中，当变量需要修改的时候，只要修噶web.xml并重启服务器就可以了，不需要修改Servlet类。

###2、上下文参数（context-param）
　　由于<init-param>是配置在<servlet>中的，所以只能有这个Servlet来读取，且不能被其他的Servlet读取。如果需要配置一个让所有Servlet都能读取的参数，那就需要用到上下文参数<context-param>,这是一个全局参数，或叫做文档参数。

　　Sevlet容器在启动的时候会加载上下文参数。

**web.xml中配置的上下文参数context-param**

	  <context-param>
	  	<param-name>context_key</param-name>
	  	<param-value>context_value</param-value>
	  </context-param>

**自定义的Sevlet中获取上下文参数**

	@Override
	protected void service(HttpServletRequest req, HttpServletResponse resp)
			throws ServletException, IOException {
		resp.setContentType("text/html;charset=utf-8");
		PrintWriter out = resp.getWriter();
		
		out.println("Servlet容器启动时加载的application范围内的参数：  "+
							this.getServletContext().getInitParameter("context_key"));
		out.println("MyServlet 处理业务逻辑。。。");
		out.flush();
		out.close();
	}

**DMEO:context-param常用来加载Spring的配置文件**

	<context-param>
		<param-name>contextConfigLocation</param-name>
		<param-value>classpath*:application-context.spring.xml</param-value>
	</context-param>

　　注意：初始化参数和上下文参数，只能配置简单的字符串类型的参数，如果需要配置更多更灵活的参数，建议写到xml和properties文件中，然后编写程序读取这些文件。